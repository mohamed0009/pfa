<div class="recommendations-container">
  <header class="page-header">
    <div class="header-content">
      <h1>Recommandations de Cours</h1>
      <p>Recommandations basées sur les conversations des apprenants avec le chat AI</p>
    </div>
  </header>

  <!-- Filters & Search -->
  <div class="filters-section">
    <div class="search-box">
      <span class="material-icons">search</span>
      <input 
        type="text" 
        placeholder="Rechercher une recommandation..." 
        [(ngModel)]="searchTerm"
        (input)="filterRecommendations()">
    </div>

    <div class="filter-controls">
      <select [(ngModel)]="selectedStatus" (change)="onStatusChange()">
        <option value="all">Tous les statuts</option>
        <option value="PENDING">En attente</option>
        <option value="ACCEPTED">Acceptées</option>
        <option value="REJECTED">Rejetées</option>
      </select>

      <select *ngIf="students.length > 0" [(ngModel)]="selectedStudent" (change)="onStudentChange()">
        <option value="all">Tous les apprenants</option>
        <option *ngFor="let student of students" [value]="student.id">{{ student.name }}</option>
      </select>
    </div>
  </div>

  <!-- Loading -->
  <div *ngIf="isLoading" class="loading">
    <div class="spinner"></div>
    <p>Chargement des recommandations...</p>
  </div>

  <!-- Recommendations List -->
  <div *ngIf="!isLoading && filteredRecommendations.length > 0" class="recommendations-list">
    <div *ngFor="let recommendation of filteredRecommendations" 
         class="recommendation-card"
         [routerLink]="['/trainer/recommendations', recommendation.id]">
      
      <div class="recommendation-header">
        <div class="student-info">
          <span class="material-icons">person</span>
          <div>
            <h3>{{ recommendation.studentName || 'Apprenant' }}</h3>
            <p class="student-email">{{ recommendation.studentEmail }}</p>
          </div>
        </div>
        
        <div class="status-badge" [style.background-color]="getStatusColor(recommendation.status) + '20'"
             [style.color]="getStatusColor(recommendation.status)">
          {{ getStatusLabel(recommendation.status) }}
        </div>
      </div>

      <div class="course-info" *ngIf="recommendation.course">
        <h4>{{ recommendation.course.title }}</h4>
        <p class="course-description" *ngIf="recommendation.course.description">
          {{ recommendation.course.description.length > 150 ? (recommendation.course.description.substring(0, 150) + '...') : recommendation.course.description }}
        </p>
      </div>

      <div class="recommendation-reason">
        <span class="material-icons">lightbulb</span>
        <p>{{ recommendation.reason }}</p>
      </div>

      <div *ngIf="recommendation.conversationExcerpt" class="conversation-excerpt">
        <span class="material-icons">chat_bubble</span>
        <p>"{{ recommendation.conversationExcerpt }}"</p>
      </div>

      <div class="recommendation-footer">
        <div class="confidence-score">
          <span class="label">Score de confiance:</span>
          <div class="score-bar">
            <div class="score-fill" 
                 [style.width.%]="recommendation.confidenceScore"
                 [style.background-color]="getConfidenceColor(recommendation.confidenceScore)"></div>
          </div>
          <span class="score-value">{{ recommendation.confidenceScore.toFixed(0) }}%</span>
        </div>
        
        <span class="material-icons chevron">chevron_right</span>
      </div>
    </div>
  </div>

  <!-- Empty State -->
  <div *ngIf="!isLoading && filteredRecommendations.length === 0" class="empty-state">
    <span class="material-icons">recommend</span>
    <h3>Aucune recommandation trouvée</h3>
    <p *ngIf="selectedStatus !== 'all' || selectedStudent !== 'all'">
      Essayez de modifier les filtres pour voir plus de résultats.
    </p>
    <p *ngIf="selectedStatus === 'all' && selectedStudent === 'all'">
      Aucune recommandation n'a été générée pour le moment.
    </p>
  </div>
</div>

